<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…»è€é‡‘è§„åˆ’ç»“æœ</title>
    <!-- ä½¿ç”¨æœ¬åœ°é™æ€æ–‡ä»¶ -->
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            font-family: 'Microsoft YaHei', sans-serif;
            padding-top: 20px;
        }
        .card {
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: none;
            margin-bottom: 20px;
        }
        .header-bg {
            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border-radius: 15px 15px 0 0;
            padding: 20px;
        }
        .result-card {
            background: white;
            border-left: 5px solid #4facfe;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        .match-badge {
            font-size: 14px;
            padding: 5px 15px;
            border-radius: 20px;
        }
        .match-high { background-color: #28a745; color: white; }
        .match-medium { background-color: #ffc107; color: black; }
        .match-low { background-color: #dc3545; color: white; }
        .company-logo {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: bold;
        }
        .back-btn {
            background: linear-gradient(90deg, #6a11cb 0%, #2575fc 100%);
            border: none;
            padding: 10px 30px;
            border-radius: 50px;
            color: white;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }
        .back-btn:hover {
            transform: scale(1.05);
            color: white;
            box-shadow: 0 5px 15px rgba(106, 17, 203, 0.4);
        }
        .progress-bar-custom {
            height: 25px;
            border-radius: 15px;
            background: linear-gradient(90deg, #ff9a9e 0%, #fad0c4 100%);
        }
        .product-card {
            transition: transform 0.3s ease;
            cursor: pointer;
        }
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }
        .btn-outline-primary {
            border-color: #0d6efd;
            color: #0d6efd;
        }
        .btn-outline-primary:hover {
            background-color: #0d6efd;
            color: white;
        }
        .btn-outline-secondary {
            border-color: #6c757d;
            color: #6c757d;
        }
        .btn-outline-secondary:hover {
            background-color: #6c757d;
            color: white;
        }
        .btn-outline-success {
            border-color: #198754;
            color: #198754;
        }
        .btn-outline-success:hover {
            background-color: #198754;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container py-5">
        <div class="row">
            <div class="col-lg-10 mx-auto">
                <!-- è¿”å›æŒ‰é’® -->
                <div class="mb-4">
                    <a href="/" class="back-btn">
                        <i class="bi bi-arrow-left"></i> é‡æ–°è§„åˆ’
                    </a>
                </div>

                <!-- æ ‡é¢˜å¡ç‰‡ -->
                <div class="card">
                    <div class="card-header header-bg">
                        <div class="row align-items-center">
                            <div class="col-auto">
                                <i class="bi bi-file-earmark-text fs-1"></i>
                            </div>
                            <div class="col">
                                <h1 class="mb-0">ğŸ“Š æ‚¨çš„å…»è€é‡‘è§„åˆ’æŠ¥å‘Š</h1>
                                <p class="mb-0">ç”Ÿæˆæ—¶é—´: {{ analysis_time }}</p>
                                {% if system_note %}
                                <p class="mb-0"><small>{{ system_note }}</small></p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ç”¨æˆ·ä¿¡æ¯æ‘˜è¦ -->
                <div class="card">
                    <div class="card-body">
                        <h3 class="mb-4 border-bottom pb-2">
                            <i class="bi bi-person-badge me-2"></i>æ‚¨çš„ä¸ªäººä¿¡æ¯
                        </h3>
                        <div class="row">
                            <div class="col-md-3 mb-3">
                                <div class="result-card text-center">
                                    <h6 class="text-muted mb-2">å¹´é¾„</h6>
                                    <h3 class="mb-0">{{ user_data.age }}</h3>
                                    <small class="text-muted">å²</small>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="result-card text-center">
                                    <h6 class="text-muted mb-2">å¹´æ”¶å…¥</h6>
                                    <h3 class="mb-0">{{ user_data.annual_income }}</h3>
                                    <small class="text-muted">ä¸‡å…ƒ</small>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="result-card text-center">
                                    <h6 class="text-muted mb-2">é£é™©åå¥½</h6>
                                    <h3 class="mb-0">{{ user_data.risk_tolerance }}</h3>
                                    <small class="text-muted">
                                        {% if user_data.risk_tolerance == 'ä½' %}ä¿å®ˆå‹
                                        {% elif user_data.risk_tolerance == 'ä¸­ä½' %}ç¨³å¥å‹
                                        {% elif user_data.risk_tolerance == 'ä¸­' %}å¹³è¡¡å‹
                                        {% elif user_data.risk_tolerance == 'ä¸­é«˜' %}æˆé•¿å‹
                                        {% elif user_data.risk_tolerance == 'é«˜' %}è¿›å–å‹
                                        {% else %}{{ user_data.risk_tolerance }}
                                        {% endif %}
                                    </small>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="result-card text-center">
                                    <h6 class="text-muted mb-2">è®¡åˆ’æŠ•èµ„</h6>
                                    <h3 class="mb-0">{{ user_data.investment_amount }}</h3>
                                    <small class="text-muted">ä¸‡å…ƒ</small>
                                </div>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-4 mb-3">
                                <div class="result-card text-center">
                                    <h6 class="text-muted mb-2">æ‰€åœ¨åœ°åŒº</h6>
                                    <h5 class="mb-0">{{ user_data.location }}</h5>
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="result-card text-center">
                                    <h6 class="text-muted mb-2">ç¤¾ä¿ç±»å‹</h6>
                                    <h5 class="mb-0">{{ user_data.social_security }}</h5>
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="result-card text-center">
                                    <h6 class="text-muted mb-2">é€€ä¼‘å¹´é¾„</h6>
                                    <h5 class="mb-0">{{ user_data.retirement_age }}å²</h5>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AIåˆ†ææŠ¥å‘Š -->
                <div class="card">
                    <div class="card-body">
                        <h3 class="mb-4 border-bottom pb-2">
                            <i class="bi bi-chat-left-text me-2"></i>AIåˆ†ææŠ¥å‘Š
                        </h3>
                        <div class="result-card">
                            <div class="alert alert-info mb-3">
                                <i class="bi bi-info-circle me-2"></i>
                                æ•°æ®æ¥æºï¼š{{ source }}
                            </div>
                            <div class="report-content" style="white-space: pre-wrap; line-height: 1.6;">
{{ report }}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ç¤ºä¾‹äº§å“æ¨èï¼ˆé™æ€ç¤ºä¾‹ï¼‰ -->
                <div class="card">
                    <div class="card-body">
                        <h3 class="mb-4 border-bottom pb-2">
                            <i class="bi bi-star me-2"></i>æ¨èäº§å“ç¤ºä¾‹
                        </h3>
                        
                        <!-- äº§å“1 -->
                        <div class="card product-card mb-3">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col-auto">
                                        <div class="company-logo">
                                            å›½
                                        </div>
                                    </div>
                                    <div class="col">
                                        <h5 class="card-title mb-1">å›½å¯¿é‘«ç¦å¹´å¹´å…»è€å¹´é‡‘ä¿é™©</h5>
                                        <p class="card-text text-muted mb-2">
                                            ä¸­å›½äººå¯¿ | å…»è€å¹´é‡‘ | å¹´äº¤/è¶¸äº¤
                                        </p>
                                        <div class="d-flex align-items-center">
                                            <span class="me-3">åŒ¹é…åº¦:</span>
                                            <div class="progress flex-grow-1 me-3" style="height: 20px;">
                                                <div class="progress-bar progress-bar-custom"
                                                     role="progressbar"
                                                     style="width: 85%;"
                                                     aria-valuenow="85"
                                                     aria-valuemin="0" aria-valuemax="100">
                                                    85%
                                                </div>
                                            </div>
                                            <span class="badge match-high">
                                                85åˆ†
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mt-3">
                                    <div class="col-md-6">
                                        <h6>äº§å“è¯¦æƒ…:</h6>
                                        <ul class="list-unstyled">
                                            <li><i class="bi bi-person me-2"></i>é€‚åˆå¹´é¾„: 18-65å²</li>
                                            <li><i class="bi bi-shield me-2"></i>é£é™©ç­‰çº§: ä½é£é™©</li>
                                            <li><i class="bi bi-cash-coin me-2"></i>æœ€ä½ä¿è´¹: å¹´äº¤5000å…ƒèµ·</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6">
                                        <h6>æ¨èç†ç”±:</h6>
                                        <ul>
                                            <li>ä¸æ‚¨çš„é£é™©åå¥½åŒ¹é…åº¦é«˜</li>
                                            <li>é€‚åˆæ‚¨çš„å¹´é¾„é˜¶æ®µ</li>
                                            <li>å…¬å¸å®åŠ›å¼ºï¼Œæ”¶ç›Šç¨³å®š</li>
                                            <li>æä¾›ç»ˆèº«å…»è€ä¿éšœ</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- äº§å“2 -->
                        <div class="card product-card mb-3">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col-auto">
                                        <div class="company-logo">
                                            å¤ª
                                        </div>
                                    </div>
                                    <div class="col">
                                        <h5 class="card-title mb-1">å¤ªå¹³é‘«ç¦§å¹´å¹´ç»ˆèº«å¹´é‡‘ä¿é™©</h5>
                                        <p class="card-text text-muted mb-2">
                                            å¤ªå¹³äººå¯¿ | å¹´é‡‘ä¿é™© | æœˆäº¤/å¹´äº¤
                                        </p>
                                        <div class="d-flex align-items-center">
                                            <span class="me-3">åŒ¹é…åº¦:</span>
                                            <div class="progress flex-grow-1 me-3" style="height: 20px;">
                                                <div class="progress-bar progress-bar-custom"
                                                     role="progressbar"
                                                     style="width: 72%;"
                                                     aria-valuenow="72"
                                                     aria-valuemin="0" aria-valuemax="100">
                                                    72%
                                                </div>
                                            </div>
                                            <span class="badge match-medium">
                                                72åˆ†
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mt-3">
                                    <div class="col-md-6">
                                        <h6>äº§å“è¯¦æƒ…:</h6>
                                        <ul class="list-unstyled">
                                            <li><i class="bi bi-person me-2"></i>é€‚åˆå¹´é¾„: 25-60å²</li>
                                            <li><i class="bi bi-shield me-2"></i>é£é™©ç­‰çº§: ä¸­ä½é£é™©</li>
                                            <li><i class="bi bi-cash-coin me-2"></i>æœ€ä½ä¿è´¹: æœˆäº¤500å…ƒèµ·</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6">
                                        <h6>æ¨èç†ç”±:</h6>
                                        <ul>
                                            <li>ç¼´è´¹çµæ´»ï¼Œé€‚åˆå®šæœŸå‚¨è“„</li>
                                            <li>æä¾›èº«æ•…ä¿éšœ</li>
                                            <li>ç°é‡‘ä»·å€¼å¢é•¿ç¨³å®š</li>
                                            <li>æ”¯æŒä¿å•è´·æ¬¾åŠŸèƒ½</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="alert alert-warning mt-3">
                            <i class="bi bi-exclamation-triangle me-2"></i>
                            æ³¨ï¼šä»¥ä¸Šä¸ºç¤ºä¾‹äº§å“ï¼Œå®é™…äº§å“æ¨èè¯·å’¨è¯¢ä¸“ä¸šä¿é™©é¡¾é—®ã€‚
                        </div>
                    </div>
                </div>

                <!-- æ¸©é¦¨æç¤º -->
                <div class="card">
                    <div class="card-body">
                        <h3 class="mb-4 border-bottom pb-2">
                            <i class="bi bi-lightbulb me-2"></i>æ¸©é¦¨æç¤º
                        </h3>
                        <div class="result-card">
                            <h5>å…»è€è§„åˆ’é‡è¦æé†’ï¼š</h5>
                            <ol>
                                <li>å…»è€é‡‘è§„åˆ’æ˜¯ä¸€ä¸ªé•¿æœŸè¿‡ç¨‹ï¼Œå»ºè®®å®šæœŸï¼ˆæ¯3-5å¹´ï¼‰é‡æ–°è¯„ä¼°</li>
                                <li>ç»“åˆç¤¾ä¿å’Œä¼ä¸šå¹´é‡‘ï¼Œæ„å»ºå¤šå±‚æ¬¡çš„å…»è€ä¿éšœä½“ç³»</li>
                                <li>æ³¨æ„åˆ†æ•£æŠ•èµ„ï¼Œä¸è¦å°†å…¨éƒ¨èµ„é‡‘æŠ•å…¥å•ä¸€äº§å“</li>
                                <li>éšç€å¹´é¾„å¢é•¿ï¼Œåº”é€æ­¥é™ä½æŠ•èµ„é£é™©</li>
                                <li>å’¨è¯¢ä¸“ä¸šç†è´¢é¡¾é—®ï¼Œæ ¹æ®ä¸ªäººæƒ…å†µè°ƒæ•´æ–¹æ¡ˆ</li>
                            </ol>
                            <div class="alert alert-info mt-3">
                                <i class="bi bi-clock me-2"></i>
                                ä¸‹æ¬¡è¯„ä¼°å»ºè®®æ—¶é—´ï¼š{{ (now.year + 3) }}å¹´{{ now.month }}æœˆ
                            </div>
                        </div>
                    </div>
                </div>

                <!-- åº•éƒ¨æ“ä½œæŒ‰é’® -->
                <div class="card mt-4">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <a href="/" class="btn btn-outline-primary w-100">
                                    <i class="bi bi-house me-2"></i>è¿”å›é¦–é¡µ
                                </a>
                            </div>
                            <div class="col-md-4 mb-3">
                                <button onclick="window.print()" class="btn btn-outline-secondary w-100">
                                    <i class="bi bi-printer me-2"></i>æ‰“å°æŠ¥å‘Š
                                </button>
                            </div>
                            <div class="col-md-4 mb-3">
                                <button onclick="downloadReport()" class="btn btn-outline-success w-100">
                                    <i class="bi bi-download me-2"></i>ä¸‹è½½æŠ¥å‘Š
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/bootstrap.bundle.min.js"></script>
    <script>
        // æ·»åŠ å½“å‰å¹´ä»½åˆ°æ¨¡æ¿å˜é‡ï¼ˆç”¨äºä¸‹æ¬¡è¯„ä¼°æ—¶é—´ï¼‰
        const now = new Date();
        
        function downloadReport() {
            // è·å–æŠ¥å‘Šä¸»è¦å†…å®¹
            const reportContent = document.querySelector('.container').innerHTML;
            
            // åˆ›å»ºHTMLæ–‡ä»¶
            const htmlContent = `
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…»è€é‡‘è§„åˆ’æŠ¥å‘Š - {{ user_data.age }}å²{{ user_data.risk_tolerance }}ç”¨æˆ·</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            padding: 20px;
            background: #f8f9fa;
        }
        .report-header {
            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }
        .info-card {
            background: white;
            border-left: 5px solid #4facfe;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        .product-card {
            border: 1px solid #ddd;
            padding: 15px;
            margin: 15px 0;
            border-radius: 10px;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #666;
            font-size: 14px;
        }
        @media print {
            body { padding: 0; }
            .no-print { display: none !important; }
        }
    </style>
</head>
<body>
    <div class="report-header">
        <h1>å…»è€é‡‘è§„åˆ’æŠ¥å‘Š</h1>
        <p>ç”Ÿæˆæ—¶é—´: {{ analysis_time }}</p>
        <p>ç”¨æˆ·ID: ${now.getTime()}</p>
    </div>
    
    ${reportContent}
    
    <div class="footer">
        <p>æœ¬æŠ¥å‘Šç”±æ™ºèƒ½å…»è€é‡‘è§„åˆ’ç³»ç»Ÿç”Ÿæˆï¼Œä»…ä¾›å‚è€ƒã€‚</p>
        <p>æŠ•èµ„æœ‰é£é™©ï¼Œå†³ç­–éœ€è°¨æ…ã€‚å»ºè®®å’¨è¯¢ä¸“ä¸šç†è´¢é¡¾é—®ã€‚</p>
        <p>Â© ${now.getFullYear()} æ™ºèƒ½å…»è€é‡‘è§„åˆ’ç³»ç»Ÿ</p>
    </div>
</body>
</html>`;
            
            // åˆ›å»ºä¸‹è½½
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `å…»è€é‡‘è§„åˆ’æŠ¥å‘Š_${now.getFullYear()}${(now.getMonth()+1).toString().padStart(2,'0')}${now.getDate().toString().padStart(2,'0')}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // æ‰“å°ä¼˜åŒ–
        window.addEventListener('beforeprint', function() {
            document.querySelectorAll('.back-btn, .no-print').forEach(el => {
                el.style.display = 'none';
            });
        });
        
        window.addEventListener('afterprint', function() {
            document.querySelectorAll('.back-btn, .no-print').forEach(el => {
                el.style.display = '';
            });
        });
    </script>
</body>
</html>
